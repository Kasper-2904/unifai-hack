// =============================================================
// Mock data â€” realistic fake data for building and testing the UI
// without needing the backend running.
// =============================================================

import {
  AgentStatus,
  PlanStatus,
  PricingType,
  RiskSeverity,
  RiskSource,
  SubtaskStatus,
  TaskStatus,
  UserRole,
  type Agent,
  type MarketplaceAgent,
  type Plan,
  type Project,
  type RiskSignal,
  type SubtaskDetail,
  type Task,
  type TeamMember,
  type User,
} from "@/lib/types";

// ---- Users ----

export const mockUsers: User[] = [
  {
    id: "user-1",
    email: "martin@team.com",
    username: "martin",
    full_name: "Martin",
    is_active: true,
    created_at: "2025-06-01T10:00:00Z",
  },
  {
    id: "user-2",
    email: "kasper@team.com",
    username: "kasper",
    full_name: "Kasper",
    is_active: true,
    created_at: "2025-06-01T10:00:00Z",
  },
  {
    id: "user-3",
    email: "farhan@team.com",
    username: "farhan",
    full_name: "Farhan",
    is_active: true,
    created_at: "2025-06-01T10:00:00Z",
  },
  {
    id: "user-4",
    email: "marin@team.com",
    username: "marin",
    full_name: "Marin",
    is_active: true,
    created_at: "2025-06-01T10:00:00Z",
  },
];

// ---- Projects ----

export const mockProjects: Project[] = [
  {
    id: "proj-1",
    name: "Orchestrator MVP",
    description:
      "Team orchestration platform with OA planning, agent drafting, and reviewer gate.",
    goals: [
      "Centralize team context",
      "Automate task planning with OA",
      "Agent marketplace",
    ],
    milestones: [
      { name: "Core Setup", target_date: "2025-07-01", progress: 0.6 },
      { name: "Workflows", target_date: "2025-07-15", progress: 0.2 },
      { name: "Marketplace & Billing", target_date: "2025-08-01", progress: 0 },
    ],
    timeline: { start: "2025-06-01", end: "2025-08-15" },
    github_repo: "https://github.com/Kasper-2904/hackeurope",
    owner_id: "user-2",
    created_at: "2025-06-01T10:00:00Z",
    updated_at: "2025-06-15T14:30:00Z",
  },
  {
    id: "proj-2",
    name: "Internal Tooling",
    description: "Developer productivity scripts and CI helpers.",
    goals: ["Speed up CI", "Automate code formatting"],
    milestones: [
      { name: "CI Scripts", target_date: "2025-07-01", progress: 0.8 },
    ],
    timeline: { start: "2025-06-10", end: "2025-07-15" },
    github_repo: null,
    owner_id: "user-3",
    created_at: "2025-06-10T09:00:00Z",
    updated_at: null,
  },
];

// ---- Team Members ----

export const mockTeamMembers: TeamMember[] = [
  {
    id: "tm-1",
    user_id: "user-1",
    project_id: "proj-1",
    role: UserRole.DEVELOPER,
    skills: ["React", "TypeScript", "UI"],
    capacity: 1.0,
    current_load: 0.7,
    created_at: "2025-06-01T10:00:00Z",
    updated_at: null,
  },
  {
    id: "tm-2",
    user_id: "user-2",
    project_id: "proj-1",
    role: UserRole.PM,
    skills: ["Architecture", "Python", "DevOps"],
    capacity: 1.0,
    current_load: 0.5,
    created_at: "2025-06-01T10:00:00Z",
    updated_at: null,
  },
  {
    id: "tm-3",
    user_id: "user-3",
    project_id: "proj-1",
    role: UserRole.DEVELOPER,
    skills: ["Python", "FastAPI", "Databases"],
    capacity: 1.0,
    current_load: 0.8,
    created_at: "2025-06-01T10:00:00Z",
    updated_at: null,
  },
  {
    id: "tm-4",
    user_id: "user-4",
    project_id: "proj-1",
    role: UserRole.DEVELOPER,
    skills: ["React", "CSS", "Design"],
    capacity: 1.0,
    current_load: 0.6,
    created_at: "2025-06-01T10:00:00Z",
    updated_at: null,
  },
];

// ---- Agents ----

export const mockAgents: Agent[] = [
  {
    id: "agent-1",
    name: "CodeDrafter",
    role: "coder",
    description: "Generates code drafts from task specifications.",
    mcp_endpoint: "http://localhost:9001",
    status: AgentStatus.ONLINE,
    owner_id: "user-2",
    team_id: null,
    created_at: "2025-06-05T10:00:00Z",
    last_seen: "2025-06-20T15:00:00Z",
  },
  {
    id: "agent-2",
    name: "TestWriter",
    role: "tester",
    description: "Generates unit and integration tests.",
    mcp_endpoint: "http://localhost:9002",
    status: AgentStatus.ONLINE,
    owner_id: "user-2",
    team_id: null,
    created_at: "2025-06-05T10:00:00Z",
    last_seen: "2025-06-20T14:30:00Z",
  },
  {
    id: "agent-3",
    name: "DocWriter",
    role: "docs",
    description: "Generates and updates technical documentation.",
    mcp_endpoint: "http://localhost:9003",
    status: AgentStatus.OFFLINE,
    owner_id: "user-3",
    team_id: null,
    created_at: "2025-06-06T10:00:00Z",
    last_seen: "2025-06-18T12:00:00Z",
  },
  {
    id: "agent-4",
    name: "BugHunter",
    role: "reviewer",
    description: "Analyzes code for potential bugs and security issues.",
    mcp_endpoint: "http://localhost:9004",
    status: AgentStatus.BUSY,
    owner_id: "user-2",
    team_id: null,
    created_at: "2025-06-07T10:00:00Z",
    last_seen: "2025-06-20T15:05:00Z",
  },
  {
    id: "agent-5",
    name: "Refactorer",
    role: "coder",
    description: "Suggests and applies refactoring improvements.",
    mcp_endpoint: "http://localhost:9005",
    status: AgentStatus.ONLINE,
    owner_id: "user-3",
    team_id: null,
    created_at: "2025-06-08T10:00:00Z",
    last_seen: "2025-06-20T14:00:00Z",
  },
];

// ---- Marketplace Agents (subset published publicly) ----

export const mockMarketplaceAgents: MarketplaceAgent[] = [
  {
    id: "mp-1",
    agent_id: "agent-1",
    seller_id: "user-2",
    seller_name: null,
    name: "CodeDrafter",
    category: "code_generation",
    description: "Generates code drafts from task specifications using Claude.",
    pricing_type: PricingType.USAGE_BASED,
    price_per_use: 0.05,
    is_verified: true,
    is_active: true,
  },
  {
    id: "mp-2",
    agent_id: "agent-2",
    seller_id: "user-2",
    seller_name: null,
    name: "TestWriter",
    category: "testing",
    description: "Generates comprehensive unit and integration tests.",
    pricing_type: PricingType.FREE,
    price_per_use: null,
    is_verified: true,
    is_active: true,
  },
  {
    id: "mp-3",
    agent_id: "agent-4",
    seller_id: "user-2",
    seller_name: null,
    name: "BugHunter",
    category: "code_review",
    description: "Deep analysis of code for bugs, security flaws, and anti-patterns.",
    pricing_type: PricingType.USAGE_BASED,
    price_per_use: 0.1,
    is_verified: false,
    is_active: true,
  },
  {
    id: "mp-4",
    agent_id: "agent-5",
    seller_id: "user-3",
    seller_name: null,
    name: "Refactorer",
    category: "code_generation",
    description: "Suggests and applies clean code refactoring patterns.",
    pricing_type: PricingType.FREE,
    price_per_use: null,
    is_verified: false,
    is_active: true,
  },
];

// ---- Tasks ----

export const mockTasks: Task[] = [
  {
    id: "task-1",
    title: "Set up user authentication API",
    description: "Implement JWT auth endpoints: register, login, token refresh.",
    task_type: "code_generation",
    status: TaskStatus.COMPLETED,
    progress: 1.0,
    assigned_agent_id: "agent-1",
    team_id: null,
    created_at: "2025-06-10T09:00:00Z",
    started_at: "2025-06-10T09:30:00Z",
    completed_at: "2025-06-12T16:00:00Z",
  },
  {
    id: "task-2",
    title: "Build GitHub ingestion adapter",
    description:
      "Fetch and normalize GitHub PRs, issues, and CI status into internal models.",
    task_type: "code_generation",
    status: TaskStatus.IN_PROGRESS,
    progress: 0.6,
    assigned_agent_id: "agent-1",
    team_id: null,
    created_at: "2025-06-11T10:00:00Z",
    started_at: "2025-06-12T08:00:00Z",
    completed_at: null,
  },
  {
    id: "task-3",
    title: "Scaffold frontend repository",
    description:
      "Set up Vite + React + TypeScript + Tailwind environment with proxy.",
    task_type: "code_generation",
    status: TaskStatus.IN_PROGRESS,
    progress: 0.4,
    assigned_agent_id: null,
    team_id: null,
    created_at: "2025-06-11T10:00:00Z",
    started_at: "2025-06-13T09:00:00Z",
    completed_at: null,
  },
  {
    id: "task-4",
    title: "Implement OA planning logic",
    description:
      "Build orchestration agent that analyzes tasks and selects specialist agents.",
    task_type: "code_generation",
    status: TaskStatus.PENDING,
    progress: 0.0,
    assigned_agent_id: null,
    team_id: null,
    created_at: "2025-06-13T10:00:00Z",
    started_at: null,
    completed_at: null,
  },
  {
    id: "task-5",
    title: "Create developer dashboard UI",
    description: "Build task list, draft viewer, risk graphs, and big context mode.",
    task_type: "code_generation",
    status: TaskStatus.ASSIGNED,
    progress: 0.0,
    assigned_agent_id: "agent-1",
    team_id: null,
    created_at: "2025-06-14T10:00:00Z",
    started_at: null,
    completed_at: null,
  },
  {
    id: "task-6",
    title: "Build agent marketplace UI",
    description:
      "Catalog browse page, agent detail, and publish agent flow.",
    task_type: "code_generation",
    status: TaskStatus.PENDING,
    progress: 0.0,
    assigned_agent_id: null,
    team_id: null,
    created_at: "2025-06-15T10:00:00Z",
    started_at: null,
    completed_at: null,
  },
  {
    id: "task-7",
    title: "Add reviewer agent final gate",
    description:
      "Reviewer checks consistency with other tasks and flags merge conflicts.",
    task_type: "code_review",
    status: TaskStatus.PENDING,
    progress: 0.0,
    assigned_agent_id: null,
    team_id: null,
    created_at: "2025-06-15T11:00:00Z",
    started_at: null,
    completed_at: null,
  },
  {
    id: "task-8",
    title: "Fix CI pipeline flaky test",
    description: "Investigate and fix the intermittent auth test failure.",
    task_type: "bug_fix",
    status: TaskStatus.FAILED,
    progress: 0.3,
    assigned_agent_id: "agent-4",
    team_id: null,
    created_at: "2025-06-16T10:00:00Z",
    started_at: "2025-06-16T11:00:00Z",
    completed_at: null,
  },
];

// ---- Subtasks (for task-2 as an example) ----

export const mockSubtasks: SubtaskDetail[] = [
  {
    id: "sub-1",
    task_id: "task-2",
    plan_id: "plan-1",
    title: "Fetch GitHub PRs via API",
    description: "Connect to GitHub REST API and pull open/closed PRs.",
    priority: 1,
    status: SubtaskStatus.FINALIZED,
    assignee_id: "user-2",
    assigned_agent_id: "agent-1",
    draft_version: 2,
    risk_flags: [],
    created_at: "2025-06-12T08:00:00Z",
    updated_at: "2025-06-13T10:00:00Z",
    draft_content: {
      type: "code",
      language: "python",
      code: 'async def fetch_prs(repo: str) -> list[dict]:\n    """Fetch open PRs from GitHub."""\n    async with httpx.AsyncClient() as client:\n        resp = await client.get(\n            f"https://api.github.com/repos/{repo}/pulls",\n            headers={"Authorization": f"Bearer {token}"},\n        )\n        return resp.json()',
    },
    draft_generated_at: "2025-06-12T09:00:00Z",
    draft_agent_id: "agent-1",
    final_content: {
      type: "code",
      language: "python",
      code: "# Final implementation with error handling and pagination",
    },
    finalized_at: "2025-06-13T10:00:00Z",
    finalized_by_id: "user-2",
  },
  {
    id: "sub-2",
    task_id: "task-2",
    plan_id: "plan-1",
    title: "Normalize PR data to internal model",
    description: "Map GitHub PR fields to our unified Task/PR model.",
    priority: 2,
    status: SubtaskStatus.DRAFT_GENERATED,
    assignee_id: "user-2",
    assigned_agent_id: "agent-1",
    draft_version: 1,
    risk_flags: ["schema_mismatch"],
    created_at: "2025-06-12T08:00:00Z",
    updated_at: "2025-06-14T10:00:00Z",
    draft_content: {
      type: "code",
      language: "python",
      code: 'def normalize_pr(gh_pr: dict) -> dict:\n    return {\n        "id": gh_pr["id"],\n        "title": gh_pr["title"],\n        "status": "open" if gh_pr["state"] == "open" else "closed",\n        "author": gh_pr["user"]["login"],\n    }',
    },
    draft_generated_at: "2025-06-14T10:00:00Z",
    draft_agent_id: "agent-1",
    final_content: null,
    finalized_at: null,
    finalized_by_id: null,
  },
  {
    id: "sub-3",
    task_id: "task-2",
    plan_id: "plan-1",
    title: "Fetch CI status for each PR",
    description: "Pull check suite results from GitHub for each PR.",
    priority: 3,
    status: SubtaskStatus.PENDING,
    assignee_id: null,
    assigned_agent_id: null,
    draft_version: 0,
    risk_flags: [],
    created_at: "2025-06-12T08:00:00Z",
    updated_at: null,
    draft_content: null,
    draft_generated_at: null,
    draft_agent_id: null,
    final_content: null,
    finalized_at: null,
    finalized_by_id: null,
  },
];

// ---- Plans ----

export const mockPlans: Plan[] = [
  {
    id: "plan-1",
    task_id: "task-2",
    project_id: "proj-1",
    status: PlanStatus.APPROVED,
    plan_data: {
      summary: "Build GitHub ingestion in 3 subtasks: fetch PRs, normalize data, fetch CI status.",
      selected_agent: "CodeDrafter",
      selected_agent_reason:
        "CodeDrafter has code_generation capability and is currently online.",
      suggested_assignee: "Kasper",
      suggested_assignee_reason:
        "Kasper has DevOps and Python skills, currently at 50% capacity.",
      alternatives_considered: [
        { agent: "Refactorer", reason: "Could work but specializes in refactoring, not new code." },
      ],
    },
    approved_by_id: "user-2",
    approved_at: "2025-06-12T07:30:00Z",
    rejection_reason: null,
    version: 1,
    created_at: "2025-06-11T16:00:00Z",
    updated_at: "2025-06-12T07:30:00Z",
  },
  {
    id: "plan-2",
    task_id: "task-5",
    project_id: "proj-1",
    status: PlanStatus.PENDING_PM_APPROVAL,
    plan_data: {
      summary: "Build developer dashboard with task list, draft viewer, and risk panel.",
      selected_agent: "CodeDrafter",
      selected_agent_reason:
        "CodeDrafter is the primary code generation agent for this project.",
      suggested_assignee: "Martin",
      suggested_assignee_reason:
        "Martin has React and UI skills, assigned as frontend lead.",
      alternatives_considered: [],
    },
    approved_by_id: null,
    approved_at: null,
    rejection_reason: null,
    version: 1,
    created_at: "2025-06-14T11:00:00Z",
    updated_at: null,
  },
];

// ---- Risk Signals ----

export const mockRiskSignals: RiskSignal[] = [
  {
    id: "risk-1",
    project_id: "proj-1",
    task_id: "task-2",
    subtask_id: "sub-2",
    source: RiskSource.REVIEWER,
    severity: RiskSeverity.MEDIUM,
    title: "Schema mismatch in PR normalization",
    description:
      "The normalized PR model is missing the 'reviewers' field required by the task graph.",
    rationale:
      "Reviewer Agent detected that TASK_GRAPH.md expects a reviewers array on every PR entity, but the draft normalizer omits it.",
    recommended_action:
      "Add a 'reviewers' field to the normalize_pr function mapped from gh_pr['requested_reviewers'].",
    is_resolved: false,
    resolved_at: null,
    resolved_by_id: null,
    created_at: "2025-06-14T12:00:00Z",
    updated_at: null,
  },
  {
    id: "risk-2",
    project_id: "proj-1",
    task_id: "task-8",
    subtask_id: null,
    source: RiskSource.CI_FAILURE,
    severity: RiskSeverity.HIGH,
    title: "Flaky auth test failing intermittently",
    description: "The test_login_with_expired_token test fails ~30% of the time.",
    rationale:
      "CI logs show the test depends on system clock timing. Race condition between token generation and validation.",
    recommended_action:
      "Mock the datetime in the test to ensure deterministic token expiry.",
    is_resolved: false,
    resolved_at: null,
    resolved_by_id: null,
    created_at: "2025-06-16T12:00:00Z",
    updated_at: null,
  },
  {
    id: "risk-3",
    project_id: "proj-1",
    task_id: "task-2",
    subtask_id: null,
    source: RiskSource.MERGE_CONFLICT,
    severity: RiskSeverity.LOW,
    title: "Potential conflict with auth branch",
    description:
      "Both task-1 and task-2 modify the src/api/routes.py file.",
    rationale:
      "Reviewer found overlapping line ranges in routes.py between the auth PR and the GitHub ingestion PR.",
    recommended_action: "Coordinate merge order: merge auth branch first, then rebase ingestion.",
    is_resolved: true,
    resolved_at: "2025-06-13T09:00:00Z",
    resolved_by_id: "user-2",
    created_at: "2025-06-12T14:00:00Z",
    updated_at: "2025-06-13T09:00:00Z",
  },
];
